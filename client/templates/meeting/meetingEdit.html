<template name="meetingEdit">

  {{#if userCanEditMeeting}}

    {{#with meetingData}}
      {{> barHeader title="Edit Meeting" leftType="cancel" rightType="done"}}
    {{/with}}

    {{#ionView}}
      {{#ionContent}}
        {{#ionList}}
          {{#with meetingData}}
            {{>meetingFields}}
          {{/with}}

          {{#with meetingData}}
            <div class="item item-divider">
              Intermediate Hymn
              <button id="addIntermediateHymnButton" type="button" class="button button-clear button-small pull-right">
                Add
                <span class="icon ion-plus"></span>
              </button>
            </div>
          {{/with}}

          {{#each intermediateHymnData}}
            <div class="list list-inset">
              <a class="item item-icon-right intermediateHymnItem" href="{{pathFor 'hymnSelect'}}">
                Hymn
                <span class="item-note">
                  {{#if hymn.number}}
                    {{hymn.number}} -
                  {{/if}}
                  {{hymn.name}}
                </span>
                <i class="icon ion-ios-arrow-right"></i>
              </a>
              <label class="item item-input item-select">
                <div class="input-label">
                  Performed After Speaker
                </div>
                <select id="{{_id}}" class="intermediateHymnAfterSpeakerSelect">
                  <option {{isSelected afterSpeaker 1}}>1</option>
                  <option {{isSelected afterSpeaker 2}}>2</option>
                  <option {{isSelected afterSpeaker 3}}>3</option>
                  <option {{isSelected afterSpeaker 4}}>4</option>
                  <option {{isSelected afterSpeaker 5}}>5</option>
                  <option {{isSelected afterSpeaker 6}}>6</option>
                </select>
              </label>
              <div class="item item-divider">
                <button type="button" class="button button-clear button-small pull-right removeIntermediateHymnButton">
                  Remove
                  <span class="icon ion-close"></span>
                </button>
              </div>
            </div>
          {{/each}}

          {{#with meetingData}}
            <div class="item item-divider">
              Musical Number
              <button id="addMusicalNumberButton" type="button" class="button button-clear button-small pull-right">
                Add
                <span class="icon ion-plus"></span>
              </button>
            </div>
          {{/with}}

          {{#each musicalNumberData}}
            <div class="list list-inset">
              <a class="item item-icon-right musicalNumberHymnItem" href="{{pathFor 'hymnSelect'}}">
                Song
                <span class="item-note">
                  {{#if hymn.number}}
                    {{hymn.number}} -
                  {{/if}}
                  {{hymn.name}}
                </span>
                <i class="icon ion-ios-arrow-right"></i>
              </a>
              <a class="item item-icon-right musicalNumberPerformerItem" href="{{pathFor 'memberSelect'}}">
                Performer
                <span class="item-note">{{performer.switchedPreferredName}}</span>
                <i class="icon ion-ios-arrow-right"></i>
              </a>
              <a class="item item-icon-right musicalNumberAccompanistItem" href="{{pathFor 'memberSelect'}}">
                Accompanist
                <span class="item-note">{{accompanist.switchedPreferredName}}</span>
                <i class="icon ion-ios-arrow-right"></i>
              </a>
              <label class="item item-input item-select">
                <div class="input-label">
                  Performed After Speaker
                </div>
                <select id="{{_id}}" class="musicalNumberAfterSpeakerSelect">
                  <option {{isSelected afterSpeaker 1}}>1</option>
                  <option {{isSelected afterSpeaker 2}}>2</option>
                  <option {{isSelected afterSpeaker 3}}>3</option>
                  <option {{isSelected afterSpeaker 4}}>4</option>
                  <option {{isSelected afterSpeaker 5}}>5</option>
                  <option {{isSelected afterSpeaker 6}}>6</option>
                </select>
              </label>
              <div class="item item-divider">
                <button type="button" class="button button-clear button-small pull-right removeMusicalNumberButton">
                  Remove
                  <span class="icon ion-close"></span>
                </button>
              </div>
            </div>
          {{/each}}

          {{#with meetingData}}
            <div class="item item-divider">
              Announcements
              <button id="addAnnouncementButton" type="button" class="button button-clear button-small pull-right">
                Add
                <span class="icon ion-plus"></span>
              </button>
            </div>
          {{/with}}

          {{#each announcementData}}
            <div class="list list-inset">
              <label class="item item-input">
                <input type="text" id="{{_id}}" placeholder="Announcement" class="announcementInput" value="{{text}}">
              </label>
              <div class="item item-divider">
                <button type="button" class="button button-clear button-small pull-right removeAnnouncementButton">
                  Remove
                  <span class="icon ion-close"></span>
                </button>
              </div>
            </div>
          {{/each}}

          {{#with meetingData}}
            <div class="item item-divider">
              Visitors
              <button id="addVisitorButton" type="button" class="button button-clear button-small pull-right">
                Add
                <span class="icon ion-plus"></span>
              </button>
            </div>
          {{/with}}

          {{#each visitorData}}
            <div class="list list-inset">
              <a id="{{_id}}" class="item item-icon-right visitorItem" href="{{pathFor 'memberSelect'}}">
                Visitor
                <span class="item-note">{{visitor.switchedPreferredName}}</span>
                <i class="icon ion-ios-arrow-right"></i>
              </a>
              <div class="item item-divider">
                <button type="button" class="button button-clear button-small pull-right removeVisitorButton">
                  Remove
                  <span class="icon ion-close"></span>
                </button>
              </div>
            </div>
          {{/each}}

          {{#with meetingData}}
            <div class="item item-divider">
              Speakers
              <button id="addSpeakerButton" type="button" class="button button-clear button-small pull-right">
                Add
                <span class="icon ion-plus"></span>
              </button>
            </div>
          {{/with}}

          {{#each speakerData}}
            <div class="list list-inset">
              <a id="{{_id}}" class="item item-icon-right speakerItem" href="{{pathFor 'memberSelect'}}">
                Speaker
                <span class="item-note">{{speaker.switchedPreferredName}}</span>
                <i class="icon ion-ios-arrow-right"></i>
              </a>
              <div class="item item-divider">
                <button type="button" class="button button-clear button-small pull-right removeSpeakerButton">
                  Remove
                  <span class="icon ion-close"></span>
                </button>
              </div>
            </div>
          {{/each}}

          {{#with meetingData}}
            <div class="item item-divider">
              Ordinances and Recognitions
              <button id="addRecognitionButton" type="button" class="button button-clear button-small pull-right">
                Add
                <span class="icon ion-plus"></span>
              </button>
            </div>
          {{/with}}

          {{#each recognitionData}}
            <div class="list list-inset">
              <div id="{{_id}}" class="recognitionItem">
                <a class="item item-icon-right recognitionTypeItem" href="{{pathFor 'recognitionTypeSelect'}}">
                  Type
                  <span class="item-note">{{recognitionType.typeName}}</span>
                  <i class="icon ion-ios-arrow-right"></i>
                </a>
                <div class="item item-divider">
                  Members
                  <button type="button" class="button button-clear button-small pull-right addRecognitionMemberButton">
                    Add
                    <span class="icon ion-plus"></span>
                  </button>
                </div>
                <div class="list list-inset">
                  {{#each members}}
                    <a class="item item-icon-right recognitionMemberItem" href="{{pathFor 'memberSelect'}}">
                      Member
                      <span class="item-note">{{switchedPreferredName}}</span>
                      <i class="icon ion-ios-arrow-right"></i>
                    </a>
                    <div class="item item-divider">
                      <button type="button" class="button button-clear button-small pull-right removeRecognitionMemberButton">
                        Remove
                        <span class="icon ion-close"></span>
                      </button>
                    </div>
                  {{/each}}
                </div>
                <div class="item item-divider">
                  <button type="button" class="button button-clear button-small pull-right removeRecognitionButton">
                    Remove
                    <span class="icon ion-close"></span>
                  </button>
                </div>
              </div>
            </div>
          {{/each}}

          {{#with meetingData}}
            <div class="item item-divider">
              Sustainings and Releases
            </div>
          {{/with}}

          {{#each callingChangeData}}
            {{>callingChangeItem}}
          {{/each}}

          {{#with meetingData}}
            <div class="item item-divider">
              &nbsp;
            </div>
            <a class="button button-positive button-full button-clear" href="/meetingPrint/{{_id}}">
              Print Meeting
            </a>
            <div class="item item-divider">
              &nbsp;
            </div>
            <a class="button button-positive button-full button-clear" data-action="showActionSheet">
              Delete Meeting
            </a>
            <div class="item item-divider">
              &nbsp;
            </div>
          {{/with}}
        {{/ionList}}
      {{/ionContent}}
    {{/ionView}}
  {{else}}
    {{> notAllowed title="Edit Meeting"}}
  {{/if}}

</template>
